import{j as e,d as V,r as n,B as T,u as $,e as J}from"./index-D2n9cPuO.js";import{C as q}from"./category.api-kPq2NmEX.js";import{P as H}from"./product.api-Cy3wYXOx.js";import{M as K,a as Q}from"./ModalDelete-D0qBAmpD.js";import{P as X}from"./ToggleSwitch-B1KMvkgZ.js";import{F as j,P as z}from"./schema.resolver-BxNfw8r1.js";import{o as B}from"./index.esm-Dzjb_IoB.js";import{u as R,C as U}from"./index.esm-BFtL9RYl.js";import{i as W}from"./Product.interface-CXwrlzQj.js";import{s as Y}from"./sales.api-CadpT-Lv.js";const A=({field:l,dropdownLabel:N="",list:u=[],className:w="",error:p})=>{const{value:t,onChange:i}=l;return e.jsxs(e.Fragment,{children:[e.jsxs("select",{value:(t==null?void 0:t.id)||"",onChange:x=>{const m=u.find(s=>s.id===x.target.value);i(m)},className:V("px-5 py-3 rounded-md border border-c6 text-lg",w,p.length>0?"border-red-700":"border-gray-c3 text-black"),children:[e.jsx("option",{value:"",disabled:!0,children:N}),u.map((x,m)=>e.jsx("option",{value:x.id,children:x.locale},m))]}),p&&e.jsx("span",{className:"text-red-700",children:p})]})},_=({field:l,dropdownLabel:N="",list:u=[],className:w="",error:p})=>{const{value:t,onChange:i}=l;return e.jsxs(e.Fragment,{children:[e.jsxs("select",{value:(t==null?void 0:t.id)||"",onChange:x=>{const m=u.find(s=>s.id===x.target.value);i(m)},className:V("px-5 py-3 rounded-md border border-c6 text-lg",w,p.length>0?"border-red-700":"border-gray-c3 text-black"),children:[e.jsx("option",{value:"",disabled:!0,children:N}),u.map((x,m)=>e.jsx("option",{value:x.id,children:x.name},m))]}),p&&e.jsx("span",{className:"text-red-700",children:p})]})},Z=({product:l,handleUpdate:N,genders:u,sales:w})=>{var y,M,P,v,D,F;const[p,t]=n.useState([]);n.useState(!0);const[i,x]=n.useState([]);n.useState(l.subImages??[]);const{handleSubmit:m,control:s,watch:C,formState:{errors:f}}=R({resolver:B(z),mode:"onSubmit",defaultValues:{...l}}),k=r=>{if(r.target.files)for(let o=0;o<r.target.files.length;o++){const g=r.target.files[o];x(S=>[...S,g])}},b=C(),I=()=>b.productName===l.productName&&b.longDescription===l.longDescription&&b.freeInformation===l.freeInformation&&b.washingInformation===l.washingInformation&&b.slug===l.slug&&b.basePrice===l.basePrice,E=r=>{console.log("data",r),N(r)},L=r=>{q.getChildCategory(r).then(o=>{t(o.data)})};n.useEffect(()=>{var o,g;const r=Object.values(f);if(r.length>0&&(o=r[0])!=null&&o.message){const S=(g=r[0])==null?void 0:g.message;T.error(S.toString(),{autoClose:1e3,pauseOnHover:!1,draggable:!0,delay:50})}},[f]),n.useEffect(()=>{var r;(r=l.gender)!=null&&r.id&&L(l.gender.id)},[]);const h=C("gender");return n.useEffect(()=>{h&&h.id!==""&&h.id&&L(h.id),console.log("gender",h)},[h]),e.jsx("div",{className:"w-[800px]",children:e.jsx("div",{className:"bg-white mt-10 rounded-md px-10 pt-10 pb-5",children:e.jsxs("form",{onSubmit:m(E),children:[e.jsx("h1",{className:"font-bold text-lg flex justify-center",children:"Thông tin sản phẩm"}),e.jsxs("div",{className:"text-right mt-10",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-10",children:[e.jsxs("div",{className:"text-left",children:[e.jsxs("label",{htmlFor:"",className:"text-lg font-semibold text-left",children:["Tên sản phẩm"," ",e.jsx("span",{className:"text-red-500",children:"(*)"})]}),e.jsx(j,{control:s,name:"productName",id:"product-name",placeholder:"Nhập tên sản phẩm...",error:((y=f.productName)==null?void 0:y.message)??""})]}),e.jsxs("div",{className:"text-left",children:[e.jsxs("label",{htmlFor:"",className:"text-lg font-semibold text-left",children:["Mô tả"," ",e.jsx("span",{className:"text-red-500",children:"(*)"})]}),e.jsx(j,{control:s,name:"longDescription",id:"long-description",placeholder:"Nhập mô tả của sản phẩm...",error:((M=f.longDescription)==null?void 0:M.message)??""})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-10",children:[e.jsxs("div",{className:"text-left",children:[e.jsxs("label",{htmlFor:"",className:"text-lg font-semibold text-left",children:["Thông tin cơ bản"," ",e.jsx("span",{className:"text-red-500",children:"(*)"})]}),e.jsx(j,{control:s,name:"freeInformation",id:"product-name",placeholder:"Nhập thông tin cơ bản của sản phẩm...",error:((P=f.freeInformation)==null?void 0:P.message)??""})]}),e.jsxs("div",{className:"text-left",children:[e.jsxs("label",{htmlFor:"",className:"text-lg font-semibold text-left",children:["Slug"," ",e.jsx("span",{className:"text-red-500",children:"(*)"})]}),e.jsx(j,{control:s,name:"slug",id:"product-slug",placeholder:"Nhập Slug...",error:((v=f.slug)==null?void 0:v.message)??"",children:"Product Slug"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-10 mt-10",children:[e.jsxs("div",{className:"text-left",children:[e.jsxs("label",{htmlFor:"",className:"text-lg font-semibold text-left",children:["Giá"," ",e.jsx("span",{className:"text-red-500",children:"(*)"})]}),e.jsx(j,{control:s,name:"basePrice",id:"basePrice",placeholder:"Nhập giá ...",type:"number",error:((D=f.basePrice)==null?void 0:D.message)??"",children:"Price"})]}),e.jsxs("div",{className:"text-left",children:[e.jsxs("label",{htmlFor:"",className:"text-lg font-semibold text-left",children:["Thông tin giặt giũ"," ",e.jsx("span",{className:"text-red-500",children:"(*)"})]}),e.jsx(j,{control:s,name:"washingInformation",id:"quantity",placeholder:"Nhập thông tin về giặt giũ...",error:((F=f.washingInformation)==null?void 0:F.message)??"",children:"Product Washing Information"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-10 mt-10",children:[e.jsxs("div",{className:"flex flex-col gap-2 text-left",children:[e.jsxs("label",{htmlFor:"",className:"text-lg font-semibold text-left",children:["Giới tính"," ",e.jsx("span",{className:"text-red-500",children:"(*)"})]}),e.jsx(U,{name:"gender",control:s,render:({field:r})=>{var o,g;return e.jsx(A,{field:r,dropdownLabel:((o=l.gender)==null?void 0:o.locale)||"Lựa chọn giới tính",list:u,error:((g=f.gender)==null?void 0:g.message)??""})}})]}),e.jsxs("div",{className:"flex flex-col gap-2 text-left",children:[e.jsx("label",{htmlFor:"",className:"text-lg font-semibold text-left",children:"Product Category"}),e.jsx(U,{name:"category",control:s,render:({field:r})=>{var o,g;return e.jsx(A,{field:r,dropdownLabel:((o=l.category)==null?void 0:o.locale)||"Select Category",list:p,error:((g=f.category)==null?void 0:g.message)??""})}})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-10 mt-10",children:e.jsxs("div",{className:"flex flex-col gap-2 text-left",children:[e.jsx("label",{htmlFor:"",className:"text-lg font-semibold text-left",children:"Khuyến mãi"}),e.jsx(U,{name:"sales",control:s,render:({field:r})=>{var o;return e.jsx(_,{field:r,dropdownLabel:"lựa chọn khuyến mãi",list:w,error:((o=f.sales)==null?void 0:o.message)??""})}})]})}),e.jsx("div",{className:"mt-10 text-left flex items-center",children:e.jsx("input",{type:"file",multiple:!0,onChange:k,className:"w-2/4 px-4 py-2 rounded-lg border border-c6"})}),e.jsx("div",{className:"flex mt-2"}),e.jsx("button",{type:"submit",className:V("mt-10 font-semibold px-4 py-2 rounded-md inline-block transition-all",I()?"bg-gray-300 text-gray-500 cursor-not-allowed":"text-white bg-gradient-to-br from-orange-500 to-pink-500 hover:from-orange-600 hover:to-pink-600 cursor-pointer"),disabled:I(),children:"Update Product"})]})]})})})},ee=({handleCreateNew:l,genders:N,sales:u})=>{var D,F,r,o,g,S;const[w,p]=n.useState([]),{handleSubmit:t,control:i,reset:x,setValue:m,formState:{errors:s},watch:C}=R({resolver:B(z),mode:"onSubmit",defaultValues:W}),[f,k]=n.useState([]),[b,I]=n.useState(!0),[E,L]=n.useState([]),h=C(),y=()=>h.productName===""&&h.longDescription===""&&h.freeInformation===""&&h.washingInformation===""&&h.slug===""&&h.basePrice===0&&h.gender===null&&h.category===null,M=c=>{if(c.target.files)for(let a=0;a<c.target.files.length;a++){const d=c.target.files[a];k(G=>[...G,d]);const O={id:"",fileName:d.name,fileType:d.type,url:""};L(G=>[...G,O])}},P=c=>{console.log("data",c),I(!1),setTimeout(()=>{I(!0),l(c)},5e3)};n.useEffect(()=>{m("subImages",E)},[E,m]),n.useEffect(()=>{var c,a;if(s.gender)T.error(s.gender.message,{autoClose:1e3,pauseOnHover:!1,draggable:!0,delay:50});else if(s.productName)T.error(s.productName.message,{autoClose:1e3,pauseOnHover:!1,draggable:!0,delay:50});else{const d=Object.values(s);if(d.length>0&&(c=d[0])!=null&&c.message){const O=(a=d[0])==null?void 0:a.message;T.error(O.toString(),{autoClose:1e3,pauseOnHover:!1,draggable:!0,delay:50})}}},[s]);const v=C("gender");return n.useEffect(()=>{v&&v.id!==""&&v.id&&q.getChildCategory(v.id).then(c=>{c.data&&p(c.data)})},[v]),e.jsx("div",{className:"w-[1000px]",children:e.jsx("div",{className:"bg-white mt-10 rounded-md px-10 pt-10 pb-5",children:e.jsxs("form",{onSubmit:t(P),children:[e.jsx("h1",{className:"font-bold text-2xl flex justify-center",children:"Thêm mới sản phẩm"}),e.jsxs("div",{className:"text-right mt-10",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-10",children:[e.jsxs("div",{className:"text-left",children:[e.jsxs("label",{htmlFor:"",className:"text-lg font-semibold text-left",children:["Tên sản phẩm"," ",e.jsx("span",{className:"text-red-500",children:"(*)"})]}),e.jsx(j,{control:i,name:"productName",id:"product-name",placeholder:"Nhập tên sản phẩm...",error:((D=s.productName)==null?void 0:D.message)??""})]}),e.jsxs("div",{className:"text-left",children:[e.jsxs("label",{htmlFor:"",className:"text-lg font-semibold text-left",children:["Mô tả"," ",e.jsx("span",{className:"text-red-500",children:"(*)"})]}),e.jsx(j,{control:i,name:"longDescription",id:"long-description",placeholder:"Nhập mô tả của sản phẩm...",error:((F=s.longDescription)==null?void 0:F.message)??""})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-10",children:[e.jsxs("div",{className:"text-left",children:[e.jsxs("label",{htmlFor:"",className:"text-lg font-semibold text-left",children:["Thông tin cơ bản"," ",e.jsx("span",{className:"text-red-500",children:"(*)"})]}),e.jsx(j,{control:i,name:"freeInformation",id:"product-name",placeholder:"Nhập thông tin cơ bản của sản phẩm...",error:((r=s.freeInformation)==null?void 0:r.message)??""})]}),e.jsxs("div",{className:"text-left",children:[e.jsxs("label",{htmlFor:"",className:"text-lg font-semibold text-left",children:["Slug"," ",e.jsx("span",{className:"text-red-500",children:"(*)"})]}),e.jsx(j,{control:i,name:"slug",id:"product-slug",placeholder:"Nhập Slug...",error:((o=s.slug)==null?void 0:o.message)??""})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-10 mt-10",children:[e.jsxs("div",{className:"text-left",children:[e.jsxs("label",{htmlFor:"",className:"text-lg font-semibold text-left",children:["Giá"," ",e.jsx("span",{className:"text-red-500",children:"(*)"})]}),e.jsx(j,{control:i,name:"basePrice",id:"basePrice",placeholder:"Nhập giá cơ bản...",type:"number",error:((g=s.basePrice)==null?void 0:g.message)??"",children:"Price"})]}),e.jsxs("div",{className:"text-left",children:[e.jsxs("label",{htmlFor:"",className:"text-lg font-semibold text-left",children:["Thông tin giặt giũ"," ",e.jsx("span",{className:"text-red-500",children:"(*)"})]}),e.jsx(j,{control:i,name:"washingInformation",id:"quantity",placeholder:"Nhập thông tin về giặt giũ...",error:((S=s.washingInformation)==null?void 0:S.message)??""})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-10 mt-10",children:[e.jsxs("div",{className:"flex flex-col gap-2 text-left",children:[e.jsxs("label",{htmlFor:"",className:"text-lg font-semibold text-left",children:["Giới tính"," ",e.jsx("span",{className:"text-red-500",children:"(*)"})]}),e.jsx(U,{name:"gender",control:i,render:({field:c})=>{var a;return e.jsx(A,{field:c,dropdownLabel:"Lựa chọn giới tính",list:N,error:((a=s.gender)==null?void 0:a.message)??""})}})]}),e.jsxs("div",{className:"flex flex-col gap-2 text-left",children:[e.jsxs("label",{htmlFor:"",className:"text-lg font-semibold text-left",children:["Loại sản phẩm"," ",e.jsx("span",{className:"text-red-500",children:"(*)"})]}),e.jsx(U,{name:"category",control:i,render:({field:c})=>{var a;return e.jsx(A,{field:c,dropdownLabel:"lựa chọn phân loại",list:w,error:((a=s.category)==null?void 0:a.message)??""})}})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-10 mt-10",children:e.jsxs("div",{className:"flex flex-col gap-2 text-left",children:[e.jsx("label",{htmlFor:"",className:"text-lg font-semibold text-left",children:"Khuyến mãi"}),e.jsx(U,{name:"sales",control:i,render:({field:c})=>{var a;return e.jsx(_,{field:c,dropdownLabel:"lựa chọn khuyến mãi",list:u,error:((a=s.sales)==null?void 0:a.message)??""})}})]})}),e.jsxs("div",{className:"mt-10 text-left items-center",children:[e.jsxs("label",{className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",htmlFor:"file_input",children:["Upload file"," ",e.jsx("span",{className:"text-red-500",children:"(* Cần có ít nhất 1 ảnh của sản phẩm)"})]}),e.jsx("div",{className:"flex",children:e.jsx("input",{type:"file",multiple:!0,onChange:M,className:"w-full text-gray-500 font-medium text-sm bg-gray-100 file:cursor-pointer cursor-pointer file:h-full file:border-0 file:py-2 file:px-4 file:mr-4 file:bg-gray-800 file:hover:bg-gray-700 file:text-white rounded"})})]}),e.jsx("button",{type:"submit",className:(V("ml-4 h-12 w-[130px] rounded-md text-white font-semibold"),f.length===0?"cursor-no-drop bg-gradient-to-br from-orange-200 to-pink-200":b?"bg-gradient-to-br from-orange-500 to-pink-500":"cursor-wait bg-gradient-to-br from-orange-500 to-pink-500")}),e.jsx("button",{type:"submit",className:V("mt-4 ml-4 h-12 w-[130px] rounded-md text-white font-semibold",y()?"cursor-no-drop bg-gradient-to-br from-orange-200 to-pink-200":b?"bg-gradient-to-br from-orange-500 to-pink-500":"cursor-wait bg-gradient-to-br from-orange-500 to-pink-500"),disabled:y(),children:y()||b?"Thêm mới":e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("div",{className:"w-7 h-7 bg-transparent border-[3px] border-t-[3px] border-t-transparent animate-spin border-white rounded-full"})})})]})]})})})},se=({products:l,onCloseUpdate:N,onCloseDelete:u,setIdDeleted:w})=>{const p=$();return e.jsx("div",{children:e.jsxs("table",{className:"bg-white w-full text-sm text-left text-gray-400",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"py-3 px-6",children:"Tên sản phẩm"}),e.jsx("th",{scope:"col",className:"py-3 px-6",children:"Mô tả"}),e.jsx("th",{scope:"col",className:"py-3 px-6",children:"Thông tin cơ bản"}),e.jsx("th",{scope:"col",className:"py-3 px-6",children:"Thông tin giặt giũ"}),e.jsx("th",{scope:"col",className:"py-3 px-6",children:"Slug"}),e.jsx("th",{scope:"col",className:"py-3 px-6",children:"Giá"}),e.jsx("th",{scope:"col",className:"py-3 px-6",children:"Khuyến mãi"}),e.jsx("th",{scope:"col",className:"py-3 px-6",children:"Giới tính"}),e.jsx("th",{scope:"col",className:"py-3 px-6",children:"Loại"}),e.jsx("th",{scope:"col",className:"px-6 text-center",children:"Hành động"})]})}),e.jsx("tbody",{children:l.map(t=>{var i,x,m;return e.jsxs("tr",{className:"bg-white border border-gray-c2 hover:bg-gray-c2 ",children:[e.jsx("td",{scope:"row",className:"py-4 px-6 font-medium text-black whitespace-nowrap",children:t.productName}),e.jsx("td",{scope:"row",className:"py-4 px-6 font-medium text-black whitespace-nowrap",children:t.longDescription}),e.jsx("td",{scope:"row",className:"py-4 px-6 font-medium text-black whitespace-nowrap",children:t.freeInformation}),e.jsx("td",{scope:"row",className:"py-4 px-6 font-medium text-black whitespace-nowrap",children:t.washingInformation}),e.jsx("td",{scope:"row",className:"py-4 px-6 font-medium text-black whitespace-nowrap",children:t.slug}),e.jsx("td",{scope:"row",className:"py-4 px-6 font-medium text-black whitespace-nowrap",children:t.basePrice}),e.jsx("td",{scope:"row",className:"py-4 px-6 font-semibold text-red-500 whitespace-nowrap",children:(i=t.sales)!=null&&i.discount?t.sales.discount+"%":"No sale"}),e.jsx("td",{scope:"row",className:"py-4 px-6 font-medium text-black whitespace-nowrap",children:(x=t.gender)==null?void 0:x.locale}),e.jsx("td",{scope:"row",className:"py-4 px-6 font-medium text-black whitespace-nowrap",children:(m=t.category)==null?void 0:m.locale}),e.jsx("td",{children:e.jsxs("div",{className:"text-center font-bold",children:[e.jsx("span",{className:"cursor-pointer text-white hover:bg-white hover:text-black bg-blue-500  rounded-lg px-2 mx-2 duration-300",onClick:()=>p(`detail/${t.slug}`),children:"View"}),e.jsx("span",{className:"cursor-pointer text-white hover:bg-white hover:text-black bg-success  rounded-lg px-2 mx-2 duration-300",onClick:()=>N(t),children:"Update"}),e.jsx("span",{className:"cursor-pointer text-white bg-red-500 rounded-lg px-2 hover:bg-white hover:text-black mx-2 duration-300",onClick:()=>{w((t==null?void 0:t.id)??""),u()},children:"Delete"})]})})]},t.id)})})]})})},xe=()=>{const[l,N]=n.useState(1),[u,w]=n.useState(1),[p,t]=n.useState([]),[i,x]=n.useState([]),[m,s]=n.useState(!1),[C,f]=n.useState(!1),[k,b]=n.useState(!1),[I,E]=n.useState(""),[L,h]=n.useState([]),[y,M]=n.useState(W),P=async a=>{await H.getAllProducts(a-1,5,"productName","asc").then(d=>{h(d.data.items),w(d.data.totalPages)})},v=()=>{s(!m)},D=a=>{H.addProduct(a).then(d=>{d.data&&(v(),T.success("Create Product success!",{autoClose:1e3,pauseOnHover:!1,draggable:!0,delay:50}),P(l))})},F=a=>{M(a),f(!C)},r=()=>{f(!C)},o=a=>{const d={...a,id:y.id};y.id&&H.updateProduct(d,y.id).then(O=>{O.data&&(r(),T.success("Update Product success!",{autoClose:1e3,pauseOnHover:!1,draggable:!0,delay:50}),P(l))})},g=()=>{b(!k)},S=a=>{b(!k),H.deleteProduct(a).then(d=>{d.result&&(T.success("Delete Product success!",{autoClose:1e3,pauseOnHover:!1,draggable:!0,delay:50}),P(l))})},c=a=>{N(a)};return n.useEffect(()=>{P(l)},[l]),n.useEffect(()=>{(async()=>{q.getCategoriesListByLevel(1).then(d=>{t(d.data)}),Y.getListSales().then(d=>{x(d.data)})})()},[]),e.jsxs(e.Fragment,{children:[e.jsx(K,{isVisible:m,onClose:v,children:e.jsx("div",{children:e.jsx(ee,{handleCreateNew:D,genders:p,sales:i})})}),e.jsx(K,{isVisible:C,onClose:r,children:e.jsx("div",{children:e.jsx(Z,{product:y,handleUpdate:o,genders:p,sales:i})})}),e.jsx(K,{isVisible:k,onClose:g,children:e.jsx(Q,{id:I,handleDelete:S,title:"Are you sure to delete this product?",onCloseDelModal:g})}),e.jsx("div",{className:"",children:e.jsxs("button",{className:"flex items-center text-black bg-white p-1 mx-8 my-2 rounded-2xl border border-gray-c4",onClick:()=>{s(!0)},children:[e.jsx(J,{}),e.jsx("span",{className:"flex items-center mr-2",children:"Thêm mới"})]})}),e.jsx("div",{className:"p-5",children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border mx-4 border-gray-c4",children:e.jsx(se,{products:L,onCloseUpdate:F,setIdDeleted:E,onCloseDelete:g})})}),e.jsx("div",{className:"flex justify-center",children:e.jsx(X,{showIcons:!0,layout:"pagination",currentPage:l,totalPages:u,onPageChange:c})})]})};export{xe as default};
