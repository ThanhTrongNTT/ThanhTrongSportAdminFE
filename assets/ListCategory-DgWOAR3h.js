import{r as l,j as e,B as N,d as L,e as B}from"./index-D2n9cPuO.js";import{M as O,a as K}from"./ModalDelete-D0qBAmpD.js";import{P as R}from"./ToggleSwitch-B1KMvkgZ.js";import{C}from"./category.api-kPq2NmEX.js";import{F as P,c as H}from"./schema.resolver-BxNfw8r1.js";import{o as U}from"./index.esm-Dzjb_IoB.js";import{u as A}from"./index.esm-BFtL9RYl.js";const q=({categories:h,parentCategory:a,handleCreateNewCategory:y,handleUpdateCategory:j,handleDeleteCategory:b})=>{const[c,m]=l.useState(null),[d,g]=l.useState({categoryName:"",level:2,locale:"",parentCategory:a}),[r,u]=l.useState({categoryName:"",level:2,locale:"",parentCategory:a}),[n,p]=l.useState(!1),f=t=>{m(t.id||""),g({...t})},w=t=>{b(t)},E=()=>{r.categoryName===""?N.error("Please enter category name!"):r.locale===""?N.error("Please enter locale!"):(y(r),u({categoryName:"",level:2,locale:"",parentCategory:a}),p(!1))},S=()=>{u({categoryName:"",level:2,locale:"",parentCategory:a}),p(!1)},T=()=>{if(j(d),c&&d){const t=h.findIndex(v=>v.id===c);h[t]={...d},m(null),g({categoryName:"",level:2,locale:"",parentCategory:a})}},s=()=>{m(null),g({categoryName:"",level:2,locale:"",parentCategory:a})},i=t=>{const{name:v,value:F}=t.target;u(D=>({...D,[v]:F}))},k=t=>{const{name:v,value:F}=t.target;g(D=>({...D,[v]:F}))};return e.jsxs("div",{children:[e.jsx("h1",{className:"m-2 font-bold text-lg",children:"Danh mục con"}),e.jsx("button",{onClick:()=>p(!n),className:"px-3 font-bold py-1 bg-blue-500 text-white rounded mb-5 hover:bg-white hover:text-blue-500 border border-blue-500 transition",children:"Thêm mới"}),n&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex min-w-full p-2 mb-5 border justify-between",children:[e.jsx("div",{children:e.jsxs("label",{children:["Tên:",e.jsx("input",{type:"text",name:"categoryName",placeholder:"Category Name",value:(r==null?void 0:r.categoryName)||"",onChange:i,className:"border rounded px-2 py-1"})]})}),e.jsx("div",{children:e.jsxs("label",{children:["Tên hiển thị:",e.jsx("input",{type:"text",name:"locale",placeholder:"Category Locale",value:(r==null?void 0:r.locale)||"",onChange:i,className:"border rounded px-2 py-1"})]})}),e.jsxs("div",{className:"flex gap-x-5",children:[e.jsx("button",{className:"px-3 font-bold py-1 bg-blue-500 text-white rounded mr-2 hover:bg-white hover:text-blue-500 border border-blue-500 transition",onClick:E,children:"Thêm"}),e.jsx("button",{className:"px-3 font-bold py-1 bg-red-500 text-white rounded mr-2 hover:bg-white hover:text-red-500 border border-red-500 transition",onClick:S,children:"Hủy"})]})]})}),e.jsxs("table",{className:"min-w-full bg-white border border-gray-200",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 px-4 border-b",children:"Tên"}),e.jsx("th",{className:"py-2 px-4 border-b",children:"Tên hiển thị"}),e.jsx("th",{className:"py-2 px-4 border-b",children:"Danh mục cha"}),e.jsx("th",{className:"py-2 px-4 border-b",children:"Actions"})]})}),e.jsx("tbody",{children:h.map(t=>e.jsxs("tr",{className:"hover:bg-gray-100",children:[e.jsx("td",{className:"py-3 px-5 border-b",children:c===t.id?e.jsx("input",{type:"text",name:"categoryName",value:(d==null?void 0:d.categoryName)||"",onChange:k,className:"border rounded px-2 py-1 "}):t.categoryName}),e.jsx("td",{className:"py-2 px-4 border-b",children:c===t.id?e.jsx("input",{type:"text",name:"locale",value:(d==null?void 0:d.locale)||"",onChange:k,className:"border rounded px-2 py-1"}):t.locale}),e.jsx("td",{className:"py-2 px-4 border-b",children:t.parentCategory?t.parentCategory.locale:"N/A"}),e.jsx("td",{className:"py-2 px-4 border-b",children:c===t.id?e.jsxs("div",{children:[e.jsx("button",{onClick:T,className:"px-3 font-bold py-1 bg-green-500 text-white rounded mr-2 hover:bg-white hover:text-green-500 border border-green-500 transition",children:"Save"}),e.jsx("button",{onClick:s,className:"px-3 font-bold py-1 bg-gray-500 text-white rounded hover:bg-white hover:text-gray-500 border border-gray-500 transition",children:"Cancel"})]}):e.jsxs("div",{className:"",children:[e.jsx("button",{onClick:()=>f(t),className:"px-3 font-bold py-1 bg-blue-500 text-white rounded mr-2 hover:bg-white hover:text-blue-500 border border-blue-500 transition",children:"Edit"}),e.jsx("button",{onClick:()=>w(t.id||""),className:"px-3 font-bold py-1 bg-red-500 text-white rounded mr-2 hover:bg-white hover:text-red-500 border border-red-500 transition",children:"Delete"})]})})]},t.id))})]})]})},z=({handleUpdate:h,category:a})=>{var S,T;const{handleSubmit:y,control:j,setValue:b,formState:{errors:c},watch:m}=A({resolver:U(H),mode:"onSubmit"});l.useState(!1),l.useState();const[d,g]=l.useState([]),r=async()=>{a.id&&await C.getChildCategory(a.id).then(s=>{g(s.data)})},u=m(),n=()=>u.categoryName===a.categoryName&&u.locale===a.locale,p=s=>{C.addCategory(s).then(i=>{i.data&&(N.success("Create Category success!",{autoClose:1e3,pauseOnHover:!1,draggable:!0,delay:50}),r())})},f=s=>{s.id&&C.updateCategory(s,s.id).then(i=>{i.data&&(N.success("Update Category success!",{autoClose:1e3,pauseOnHover:!1,draggable:!0,delay:50}),r())})},w=s=>{C.deleteCategory(s).then(i=>{i.result&&(N.success("Delete Category success!",{autoClose:1e3,pauseOnHover:!1,draggable:!0,delay:50}),r())})},E=s=>{h(s)};return l.useEffect(()=>{var i,k;const s=Object.values(c);if(s.length>0&&(i=s[0])!=null&&i.message){const t=(k=s[0])==null?void 0:k.message;N.error(t.toString(),{autoClose:1e3,pauseOnHover:!1,draggable:!0,delay:50})}},[c]),l.useEffect(()=>{r(),b("categoryName",a.categoryName??""),b("locale",a.locale??"")},[]),e.jsx("div",{className:"w-[1200px]",children:e.jsxs("div",{className:"bg-white mt-10 rounded-md px-10 pt-10 pb-5",children:[e.jsxs("form",{onSubmit:y(E),children:[e.jsx("h1",{className:"font-bold text-center text-2xl",children:"Thông tin danh mục"}),e.jsxs("div",{className:"text-right mt-10",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-10",children:[e.jsxs("div",{className:"text-left",children:[e.jsxs("label",{htmlFor:"",className:"text-lg font-semibold text-left",children:["Tên"," ",e.jsx("span",{className:"text-red-500",children:"(*)"})]}),e.jsx(P,{control:j,name:"categoryName",id:"category-name",placeholder:"Nhập tên...",error:((S=c.categoryName)==null?void 0:S.message)??"",children:"Tên"})]}),e.jsxs("div",{className:"text-left",children:[e.jsx("label",{htmlFor:"",className:"text-lg font-semibold text-left",children:"Tên hiển thị"}),e.jsxs(P,{control:j,name:"locale",id:"category-locale",placeholder:"Enter Description...",error:((T=c.locale)==null?void 0:T.message)??"",children:["Tên hiển thị"," ",e.jsx("span",{className:"text-red-500",children:"(*)"})]})]})]}),e.jsx("button",{type:"submit",className:L("mt-10 font-semibold px-4 py-2 rounded-md inline-block transition-all",n()?"bg-gray-300 text-gray-500 cursor-not-allowed":"text-white bg-gradient-to-br from-orange-500 to-pink-500 hover:from-orange-600 hover:to-pink-600 cursor-pointer"),disabled:n(),children:"Cập nhật"})]})]}),e.jsx("div",{className:"text-center mt-10",children:e.jsx(q,{categories:d,parentCategory:a,handleCreateNewCategory:p,handleUpdateCategory:f,handleDeleteCategory:w})})]})})},G=({handleCreateNew:h,category:a,setCategory:y})=>{var r,u;const{handleSubmit:j,control:b,reset:c,formState:{errors:m}}=A({resolver:U(H),mode:"onSubmit",defaultValues:{categoryName:a.categoryName,locale:a.locale}}),d=()=>{c({categoryName:"",locale:""}),y({categoryName:"",locale:"",level:1,parentCategory:null,id:""})};l.useEffect(()=>{c({categoryName:a.categoryName,locale:a.locale})},[a,c]);const g=async n=>{await h(n),d()};return l.useEffect(()=>{var p,f;const n=Object.values(m);if(n.length>0&&(p=n[0])!=null&&p.message){const w=(f=n[0])==null?void 0:f.message;N.error(w.toString(),{autoClose:1e3,pauseOnHover:!1,draggable:!0,delay:50})}},[m]),e.jsx("div",{className:"w-[800px]",children:e.jsx("div",{className:"bg-white mt-10 rounded-md px-10 pt-10 pb-5",children:e.jsxs("form",{onSubmit:j(g),children:[e.jsx("h1",{className:"font-bold text-2xl text-center",children:"Khởi tạo danh mục"}),e.jsxs("div",{className:"text-right mt-10",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-10",children:[e.jsxs("div",{className:"text-left",children:[e.jsxs("label",{htmlFor:"",className:"text-lg font-semibold text-left",children:["Tên"," ",e.jsx("span",{className:"text-red-500",children:"(*)"})]}),e.jsx(P,{control:b,name:"categoryName",id:"category-name",placeholder:"Nhập tên...",error:((r=m.categoryName)==null?void 0:r.message)??"",onChange:n=>y({...a,categoryName:n.target.value}),children:"Tên danh mục"})]}),e.jsxs("div",{className:"text-left",children:[e.jsxs("label",{htmlFor:"",className:"text-lg font-semibold text-left",children:["Tên hiển thị"," ",e.jsx("span",{className:"text-red-500",children:"(*)"})]}),e.jsx(P,{control:b,name:"locale",id:"category-locale",placeholder:"Nhập tên hiển thị...",error:((u=m.locale)==null?void 0:u.message)??"",onChange:n=>{y({...a,locale:n.target.value})},children:"Locale"})]})]}),e.jsx("button",{type:"submit",className:"mt-10 font-semibold text-white bg-gradient-to-br from-orange-500 to-pink-500 hover:from-orange-600 hover:to-pink-600 px-4 py-2 rounded-md inline-block transition-all",children:"Thêm mới"})]})]})})})},$=()=>{const[h,a]=l.useState(1),[y,j]=l.useState(1),[b,c]=l.useState(!1),[m,d]=l.useState(!1),[g,r]=l.useState(!1),[u,n]=l.useState(""),[p,f]=l.useState([]),[w,E]=l.useState({categoryName:"",level:0,locale:"",parentCategory:null}),[S,T]=l.useState({categoryName:"",level:0,locale:"",parentCategory:null}),s=async o=>{await C.getAllFromLevel(1,o-1,5,"modifiedDate","").then(x=>{j(x.data.totalPages),f(x.data.items)})},i=()=>{c(!b)},k=o=>{const x={categoryName:o.categoryName,locale:o.locale,level:1,parentCategory:null};C.addCategory(x).then(M=>{M.data&&(i(),N.success("Create Category success!",{autoClose:1e3,pauseOnHover:!1,draggable:!0,delay:50}),s(h))})},t=o=>{T(o),d(!m)},v=()=>{d(!m)},F=o=>{const x={...S,categoryName:o.categoryName,locale:o.locale};x.id&&C.updateCategory(x,x.id).then(M=>{M.result&&(v(),N.success("Update Category success!",{autoClose:1e3,pauseOnHover:!1,draggable:!0,delay:50}),s(h))})},D=()=>{r(!g)},I=async o=>{r(!g),await C.deleteCategory(o).then(x=>{x&&x.result&&(N.success("Delete Success!",{autoClose:5e3,delay:50,draggable:!0,pauseOnHover:!1}),s(h))})},V=o=>{a(o)};return l.useEffect(()=>{s(h)},[h]),e.jsxs(e.Fragment,{children:[e.jsx(O,{isVisible:b,onClose:i,children:e.jsx("div",{children:e.jsx(G,{handleCreateNew:k,category:w,setCategory:E})})}),e.jsx(O,{isVisible:m,onClose:v,children:e.jsx("div",{children:e.jsx(z,{handleUpdate:F,category:S})})}),e.jsx(O,{isVisible:g,onClose:D,children:e.jsx(K,{id:u,handleDelete:I,title:"Bạn có thật sự muốn xóa không?",onCloseDelModal:D})}),e.jsx("div",{className:"",children:e.jsxs("button",{className:"flex items-center text-black bg-white p-1 mx-8 my-2 rounded-2xl border border-gray-c4",onClick:i,children:[e.jsx(B,{}),e.jsx("span",{className:"flex items-center mr-2",children:"Thêm mới"})]})}),e.jsx("div",{className:"p-5",children:e.jsx("div",{className:"overflow-x-auto rounded-2xl border mx-4 border-gray-c4 ",children:e.jsxs("table",{className:"bg-white w-full text-sm text-left text-gray-400",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"py-3 px-6",children:"Id"}),e.jsx("th",{scope:"col",className:"px-6",children:"Tên"}),e.jsx("th",{scope:"col",className:"px-6",children:"Tên hiển thị"}),e.jsx("th",{scope:"col",className:"px-6 text-center",children:"Action"})]})}),e.jsx("tbody",{children:p.map((o,x)=>e.jsxs("tr",{className:"bg-white border border-gray-c2 hover:bg-gray-c2",children:[e.jsx("th",{scope:"row",className:"py-4 px-6 font-medium text-black whitespace-nowrap",children:o.id}),e.jsx("th",{scope:"row",className:"py-4 px-6 font-medium text-black whitespace-nowrap",children:o.categoryName}),e.jsx("th",{scope:"row",className:"py-4 px-6 font-medium whitespace-nowrap",children:o.locale}),e.jsx("th",{scope:"row",className:"py-4 px-6 font-medium text-black whitespace-nowrap",children:e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-white hover:bg-white hover:text-black bg-success  rounded-lg px-2 mx-2",onClick:()=>t(o),children:"Edit"}),e.jsx("span",{className:"text-white bg-warning rounded-lg px-2 hover:bg-white hover:text-black mx-2",onClick:()=>{n(o.id??""),D()},children:"Delete"})]})})]},x))})]})})}),e.jsx("div",{className:"flex justify-center",children:e.jsx(R,{showIcons:!0,currentPage:h,totalPages:y,onPageChange:V,layout:"pagination"})})]})};export{$ as default};
